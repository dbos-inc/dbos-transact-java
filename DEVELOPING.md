# dbos-transact-java
DBOS Transact Java SDK

## Setting up dev environment

Install a recent OpenJDK. I use OpenJDK 21.    
https://adoptium.net/en-GB/temurin/releases/?os=any&arch=any&version=21

Recommended IDE IntelliJ (Community edition is fine).
But feel free to use vi or VSCode, if you are more comfortable with it.

Postgres docker container with
localhost   
port 5432   
user postgres

export PGPASSWORD = password for postgres user

## full build

```shell
./gradlew clean build
```

## formatting

The DBOS Transact Java SDK uses [Spotless](https://github.com/diffplug/spotless) for consistent formatting.
Spotless checks formatting automatically during build
If build fails because of format violations, you can update the code with the `spotlessApply` Gradle task.

```shell
./gradlew spotlessApply
```

## run tests

```shell
./gradlew clean test
```

## publish to local maven repository

```shell
./gradlew publishToMavenLocal
```

## import transact into your application

Add to your build.gradle.kts

```kotlin
implementation("dev.dbos:transact")      
implementation("ch.qos.logback:logback-classic:1.5.6")
```


## Release Versioning

DBOS Transact for Java follows the [Maven version order algorithm](https://maven.apache.org/pom.html#Version_Order_Specification).

### Creating a Release

Release branch builds are published to Maven Central.

To create a new release, run

```shell
./gradlew createRelease -PreleaseVersion=1.2.3
```

This command tags the latest commit with the version number and creates a release branch for it.
If a version number is not supplied, it is generated by incrementing the last released minor version.

### Patching a release

Release branch patch builds are published to Maven Central.
To patch a release, push the patch as a commit to the appropriate release branch.
Then, tag it with a version number:

```shell
git tag <version-number>
git push --tags
```

This version number should increment the patch number by one, as per the Maven version order algorithm.

### Preview Versions

Main branch builds may be published to Maven Central.
To facilitate publishing, main branch builds carry the automatically generated version number (i.e.incremented minor version )
as well as a prerelease tag `-m<git-commit-count>.
The git commit count is the number of commits since the last release.

### Feature Branch Versions

Feature branch builds are not designed to be published to Maven Central.
Like main branch builds, feature branch builds carry the automatically generated version number
and a prerelease tag `-a<git-commit-count>.
In Maven version order algorithm, the `-a` prerelease prefix is lower priority than the `-m` prefix.
Feature branch builds also carry an additional `-g<git-commit-hash>` prerelease tag.
